version: v1
managed:
  enabled: true
  optimize_for: CODE_SIZE

  # C++
  # go
#  go_package_prefix:
#    default: github.com/acme/weather/private/gen/proto/go
#    except:
#      - buf.build/googleapis/googleapis
#    override:
#      buf.build/acme/weather: github.com/acme/weather/gen/proto/go
  # Java

  java_multiple_files: false
  java_package_prefix: { default: io }
  java_string_check_utf8: false
#  override:
#    JAVA_PACKAGE:
#      acme/weather/v1/weather.proto: "org"

#https://buf.build/plugins
plugins:
  - plugin: buf.build/community/neoeinstein-prost:v0.2.3
    out: gen/rust
    opt:
      - compile_well_known_types
      - extern_path=.google.protobuf=::pbjson_types
  - plugin: buf.build/community/neoeinstein-prost-serde:v0.2.3
    out: gen/rust
#  - plugin: prost
#    out: gen/rust
#    opt:
#      - compile_well_known_types
#      - extern_path=.google.protobuf=::pbjson_types
#  - plugin: prost-serde
#    out: gen/rust
#  - plugin: tonic
#    out: gen/rust
#    opt:
#      - compile_well_known_types
#      - extern_path=.google.protobuf=::pbjson_types
#  - plugin: prost
#    out: gen/rust
#    opt:
#        - gen_crate=Cargo.toml.tpl
  - plugin: cpp
    out: gen/cpp
  - plugin: java
    out: gen/java
  - plugin: go
    out: gen/go
#    opt:
#      - paths=source_relative
  - plugin: go-grpc
    out: gen/go
    opt:
#      - paths=source_relative
      - require_unimplemented_servers=false
  - plugin: python
    out: gen/python
#  - name: connect-go
#    out: gen
#    opt: paths=source_relative
#  - plugin: grpc-gateway
#      out: gen/go
#      opt:
#        - paths=source_relative
#        - grpc_api_configuration=path/to/config.yaml
#        - standalone=true
#  - plugin: openapiv2
#      out: gen/openapiv2